@{
    Layout = null;


    var userid = HttpContextAccessor.HttpContext.Session.GetInt32("userid");
    var username = HttpContextAccessor.HttpContext.Session.GetString("username");
}
@model IEnumerable<helperland_1.Models.upcomingservicelist>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="images/favicon_img.png" rel="shortcut icon" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="~/css/upcomingservice.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
    <script type="text/javascript" src="~/js/upcomingservice.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap4.min.css">
    <title>Service Provider-Upcoming Service</title>
</head>
<body class="p-0 m-0">
    <div class="header1" id="topheader">
        <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #525252;" id="navbar11">
            <div class="container-fluid">
                <a class="navbar-brand" asp-controller="home" asp-action="index">
                    <img src="~/images/white-logo-transparent-background.png" style="width: 73px; height: 54px;" id="imgg2">
                </a>
                <!-- ............RightSidenav............. -->
                <div>
                    <span class="bellImg1">
                        <a href="">
                            <span class="leftt"></span>
                            <img src="~/images/icon-notification.png" alt="" height="32px" width="29px" class="mb-2 bellImg">
                            <span class="rightt"></span>
                        </a>
                    </span>
                    <span style="font-size:30px;cursor:pointer" onclick="openNav()" class="rtt"> &#9776</span>
                    <div id="mySidenav" class="sidenav">
                        <span class="nav-link">
                            Welcome,<br>
                            <div class="font-weight-bold ml-0">@username</div>
                        </span>
                        <hr style="height: 5px; color: black;" class="mt-1 mb-1">
                        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
                        <a>Dashboard</a>
                        <a asp-controller="home" asp-action="upcomingservice">New Service Request</a>
                        <a asp-controller="home" asp-action="upcomingservicetab">Upcoming services</a>
                        <a>Service Schedule</a>
                        <a asp-controller="home" asp-action="USservicehistory">Service History</a>
                        <a asp-controller="home" asp-action="blockcustomer">My Ratings</a>
                        <a>Invoices</a>
                        <a asp-controller="home" asp-action="upcomingsetting">My Settings</a>
                        <a asp-controller="home" asp-action="logout">Logout</a>
                        <hr style="height: 5px; color: black;" class="mt-1 mb-1">
                        <a asp-controller="home" asp-action="prices">Prices and Services</a>
                        <a>Warranty</a>
                        <a>Blog</a>
                        <a asp-controller="home" asp-action="contactus">Contact</a>
                        <hr style="height: 5px; color: black;" class="mt-1 mb-1">
                        <a href="" class="ml-5">
                            <svg xmlns="http://www.w3.org/2000/svg" width="9" height="18" class=" ml-3 mr-3">
                                <path fill-rule="evenodd" fill="#000" d="M1.947 3.48v2.481H0v3.033h1.947V18.1h4.001V8.995h2.685S8.885 7.541 9.7 5.95H5.963V3.876c0-.31.437-.728.868-.728H9.11V.9H6.46C1.848.9 1.947 3.27 1.947 3.48z" />
                            </svg>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="ms-3">
                                <path fill-rule="evenodd" fill="#000" d="M14.48 20H5.519A5.524 5.524 0 0 1 0 14.482V5.52C0 2.477 2.475.2 5.519.2h8.961c3.043 0 5.519 2.277 5.519 5.32v8.962A5.525 5.525 0 0 1 14.48 20zm3.744-5.518V5.52a3.748 3.748 0 0 0-3.744-3.744H5.519A3.749 3.749 0 0 0 1.774 5.52v8.962a3.749 3.749 0 0 0 3.745 3.744h8.961a3.748 3.748 0 0 0 3.744-3.744zm-2.855-8.536c-.099 0-.678-.14-.92-.381-.242-.243.221-.578.221-.921 0-.342-.463-.678-.221-.92.242-.242.821-.381.92-.381.343 0 1.111.139.92.381.242.242.381.578.381.92 0 .342-.139.678-.381.921.171.241-.577.381-.92.381zm-5.37 9.208c-2.841 0-5.153-2.312-5.153-5.054 0-2.941 2.312-5.252 5.153-5.252 2.842 0 5.153 2.311 5.153 5.252 0 2.742-2.311 5.054-5.153 5.054zm0-8.532c-1.863 0-3.379 1.516-3.379 3.478 0 1.764 1.516 3.28 3.379 3.28s3.379-1.516 3.379-3.28c0-1.962-1.516-3.478-3.379-3.478z" />
                            </svg>
                        </a>
                    </div>
                </div>
                <div class="collapse navbar-collapse dis topNavbar1" id="navbarSupportedContent">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item mt-4">
                            <div class="nav-btn">
                                <a class="nav-link1 rounded-pill py-3" asp-controller="home" asp-action="prices">Prices & services</a>
                            </div>
                        </li>
                        <li class="nav-item mt-4">
                            <div class="nav-btn">
                                <a class="nav-link1 rounded-pill py-3">Warranty</a>
                            </div>
                        </li>
                        <li class="nav-item mt-4">
                            <div class="nav-btn">
                                <a class="nav-link1 rounded-pill py-3 px-3">Blog</a>
                            </div>
                        </li>
                        <li class="nav-item mt-4">
                            <div class="nav-btn ">
                                <a class="nav-link1 rounded-pill py-3" asp-controller="home" asp-action="contactus">Contact</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <div class=" nav-btn bdr bdl">
                                <a class="navbar-brand mt-2 ml-3" href="#">
                                    <img src="~/images/icon-notification.png" alt="" height="32px" width="29px" class="d-flex">
                                </a>
                            </div>
                        </li>
                        <li class="dropdown">
                            <a class="navbar-brand mt-2 ml-4" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img src="~/images/admin-user.png" class="mr-1">
                            </a>
                            <div class="dropdown-menu dropdown-menu-right clrr" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item mt-1">Welcome,@username !</a>
                                <hr class="hrr">
                                <a class="dropdown-item" asp-controller="home" asp-action="upcomingservice">My Dashboard</a>
                                <a class="dropdown-item" asp-controller="home" asp-action="upcomingsetting">My Settings</a>
                                <a class="dropdown-item" asp-controller="home" asp-action="logout">Logout</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
    <div class="custHeader position-relative d-flex align-items-center justify-content-center">
        <p class="m-0" style="color: #4f4f4f;">Welcome, <span class="font-weight-bold" style="color: #4f4f4f;">@username!</span></p>
    </div>
    <div class="Main-dash d-flex justify-content-between m-3">
        <!-- --------------- Sidebar -------------- -->
        <div class="sidebar position-relative postion-sticky sticky-top p-0 m-0">
            <ul class="inner mb-0 h-100">
                <li>
                    <a class="text-light" aria-current="page" id="dashBoard">Dashboard</a>
                </li>
                <li>
                    <a class="text-light" id="NewService" asp-controller="home" asp-action="upcomingservice">New Service Requests</a>
                </li>
                <li>
                    <a class="text-light" id="Upcomingg" asp-controller="home" asp-action="upcomingservicetab">Upcoming Services</a>
                </li>
                <li>
                    <a id="serviceSchedulee" class="text-light">Service Schedule</a>
                </li>
                <li>
                    <a id="serviceHistoryy" class="text-light" asp-controller="home" asp-action="USservicehistory">Service History</a>
                </li>
                <li>
                    <a id="ratingss" class="text-light" asp-controller="home" asp-action="ratings">My Ratings</a>
                </li>
                <li>
                    <a id="blockCustomerr" class="text-light" asp-controller="home" asp-action="blockcustomer">Block Customer</a>
                </li>
                <li>
                    <a id="invoices" class="text-light">Invoices</a>
                </li>
                <li>
                    <a id="myNotificationss" class="text-light">Notification</a>
                </li>
            </ul>
        </div>
        <!-- -------------------All Tables List--------------------->
        <div class="whole_tables p-0 m-0">

            <!-- ---------- Upcoming Service Table -------- -->
            <div id="upcomingService" class="d-block">
                <table class="table tablee1" id="tab3">
                    <thead class="ac font-weight-bold">
                        <tr>
                            <th scope="col">
                                Service Id
                            </th>
                            <th scope="col">
                                Service Date
                            </th>
                            <th scope="col">
                                Customer Details
                            </th>
                            <th scope="col" class="text-center">Payment</th>

                            <th scope="col" class="text-center">
                                Distance
                            </th>
                            <th scope="col" class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="ac">
                        @foreach (var item in Model)
                        {
                            <tr>
                                <th scope="row" data-toggle="modal" data-target="#exampleModal" class="pop" dataid="@item.ServiceRequestId">@item.ServiceId</th>
                                <td>
                                    <a href="#servicesPop" data-toggle="modal" class="d-flex text-decoration-none font-weight-bold">
                                        <img src="~/images/calendar2.png" alt="" height="19" width="16">
                                        <p class="m-0">@item.ServiceStartDate.ToShortDateString()</p>
                                    </a>
                                    <a href="#servicesPop" data-toggle="modal" class="d-flex text-decoration-none">
                                        <img src="~/images/layer-14.png" alt="" height="19" width="16">
                                        <p class="m-0">12:00 - 18:00</p>
                                    </a>
                                </td>
                                <td>
                                    <a href="#" class="text-decoration-none">
                                        <p class="m-0">@item.FirstName @item.LastName</p>
                                        <p class="m-0">
                                            <img src="~/images/layer-15.png" alt="" height="19" width="16">
                                            <span>
                                                @item.AddressLine2 @item.AddressLine1
                                                <br />
                                                @item.PostalCode @item.City
                                            </span>
                                        </p>
                                    </a>
                                </td>
                                <td>
                                    <p class="m-0 text-center">@item.SubTotal</p>
                                </td>
                                <td>
                                    <p class="m-0 text-center">15km</p>
                                </td>
                                <td class="text-center main-btn">
                                    <a class="rounded-pill text-light text-decoration-none cancel-btn" csrid="@item.ServiceRequestId">Cancel</a>
                                </td>
                            </tr>
                        }

                    </tbody>
                    <tfoot class="ac font-weight-bold d-none">
                        <tr>
                            <th scope="col">
                                Service Id
                            </th>
                            <th scope="col">
                                Service Date
                            </th>
                            <th scope="col">
                                Customer Details
                            </th>
                            <th scope="col" class="text-center">Payment</th>
                            <th scope="col" class="text-center">
                                Distance
                            </th>
                            <th scope="col" class="text-center">Actions</th>
                        </tr>
                    </tfoot>
                </table>

            </div>
            <!-- ---------- Service History ---------- -->


        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Service details</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body srdetail d-flex">
                    @*<div class="col-sm-6">
                            <div class="vr">
                                <p class="m-0 font-weight-bold">10/02/2012 12:00-1:00</p>
                                <p><span>Duration : </span> 3hrs</p>
                            </div>
                            <div class="vr">
                                <p><span>ServiceId : </span> 8847</p>
                                <p><span>Extras : </span></p>
                                <p><span>Total Payment : </span>$54</p>
                            </div>
                            <div class="vr">
                                <p><span>Customer Name : </span>Vraj Shah</p>
                                <p><span>Service Address : </span>Addressline1,addressline2</p>
                                <p><span>Distance : </span>27m</p>
                            </div>
                            <div class="vr">
                                <p><span>comments</span></p>
                                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
                            </div>
                            <div class="justify-content-start my-2 d-flex">
                                <button type="button" class="btn-cancel mx-2">Cancel</button>
                                <button type="button" class="btn-complete">Complete</button>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3671.697915724384!2d72.49824711400726!3d23.034861321651203!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x395e8352e403437b%3A0xdc9d4dae36889fb9!2sTatvaSoft!5e0!3m2!1sen!2sin!4v1646805036684!5m2!1sen!2sin"
                                    width="100%" height="400px" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                        </div>*@
                </div>

            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-top">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-2 footer-widget">
                        <a href="#" title="Helper Hand">
                            <img src="~/lib/images/white-logo-transparent-background.png" alt="Helper Hand">
                        </a>
                    </div>
                    <div class="col-lg-8 footer-widget">
                        <ul class="footer-navigation d-flex justify-content-center">
                            <li>
                                <a title="Home" asp-controller="home" asp-action="index">Home</a>
                            </li>
                            <li>
                                <a title="About" asp-controller="home" asp-action="aboutus">About</a>
                            </li>
                            <li>
                                <a href="#" title="Testimonials">Testimonials</a>
                            </li>
                            <li>
                                <a title="FAQS" asp-controller="home" asp-action="faq">FAQS</a>
                            </li>
                            <li>
                                <a href="#" title="Insurance Policy">Insurance Policy</a>
                            </li>
                            <li>
                                <a href="#" title="Impressum">Impressum</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-lg-2 footer-widget">
                        <ul class="social-media-list d-flex justify-content-end">
                            <li>
                                <a href="#" target="_blank" title="Facebook">
                                    <img src="~/lib/images/ic-facebook.png" alt="Facebook">
                                </a>
                            </li>
                            <li>
                                <a href="#" target="_blank" title="Instagram">
                                    <img src="~/lib/images/ic-instagram.png" alt="Instagram">
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container text-center">
                <p>©2018 Helperland. All rights reserved <a href="#" title="Privacy Policy">Privacy Policy</a></p>
            </div>
        </div>
    </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
            integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
            integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2"
            crossorigin="anonymous"></script>

    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap4.min.js"></script>
    <script>
        function openNav() {
            document.getElementById("mySidenav").style.width = "250px";
        }

        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
        }
    </script>
    <script>
    $('#tab1').DataTable({
    "aaSorting": [],
    columnDefs: [{
    orderable: false,
    targets: [1, 3]
    }]
    });
    $('#tab2').DataTable({
    "aaSorting": [],
    columnDefs: [{
    orderable: false,
    targets: [1, 3, 5]
    }]
    });
    $('#tab3').DataTable({
    "aaSorting": [],
    columnDefs: [{
    orderable: false,
    targets: [4]
    }]
    });
    $('#tab4').DataTable({
    "aaSorting": [],
    columnDefs: [{
    orderable: false,
    targets: [1, 2]
    }]
    });



        $(document).on('click', ".cancel-btn", function () {
            //x = (this).attr("#srid").val();
            var id = $(this).attr("csrid");
            console.log(id);

            $.ajax({

                url: '@Url.Action("cancelservicerequest", "home")',
                type: 'post',
                data: { id: id },

                success: function (resp) {

                    alert("Data has been added successfully.");
                    location.reload();

                },
                error: function (err) {
                    alert("Error while inserting data");
                }

            });
        });

        $(".pop").on('click', function () {
            id = $(this).attr("dataid");
            console.log(id);

            $.ajax({
                url: '@Url.Action("_popup", "home")',
                type: 'get',
                dataType: 'html',
                contentType: 'application/html',
                data: {id:id},


                success: function (resp) {
                    $("#exampleModal .modal-body").html(resp);
                    $("#exampleModal").modal();
                },
                error: function (err) {
                    alert("Error while inserting data");
                }

            });
        });
        //  $(document).on('click', '#addnewaddress', function () {
        $(document).on('click', '.btn-complete', function () {
            var xx = $(this).attr("compid");
            console.log(xx);

            $.ajax({
                url: '@Url.Action("completeservice", "home")',
                type: 'post',
                data: { id: xx },


                success: function (resp) {
                    console.log(resp);

                    $(".modal").fadeOut(500);

                    $('body').removeClass('modal-open');
                    $('.modal-backdrop').remove();
                    setTimeout(
                        function () {
                            window.location.reload(true);
                        }, 1000);


                },
                error: function (err) {
                    console.log(err);
                    alert("Error while inserting data");
                }
            });
        });
    </script>
</body>

</html>